{% extends 'base.html' %}

{% macro node(n) %}
    <li class="list-group-item">
        <a href="#"
            data-bs-toggle="modal"
            data-bs-target="#editCategoryModal"
            data-category-id="{{ n.category.id }}"
            data-category-name="{{ n.category.name }}"
            data-category-description="{{ n.category.description | default(value='') }}"
            data-category-archived="{{ n.category.is_archived }}">
            {{ n.category.name }}
        </a>
        <button class="btn btn-link" type="button" data-bs-toggle="modal" data-bs-target="#addCategoryModal" data-parent-id="{{n.category.id}}" data-parent-name="{{n.category.name}}">
            <i class="bi bi-plus-circle"></i>
        </button>

        {% if n.children | length > 0 %}
            <ul class="list-group list-group-flush">
                {% for c in n.children %}
                {{ self::node(n=c) }}
                {% endfor %}
            </ul>
        {% endif %}
    </li>
{% endmacro %}

{% macro forest(nodes) %}
    <section>
        <ul class="list-group list-group-flush">
            {% for n in nodes %}
                {{ self::node(n=n) }}
            {% endfor %}
        </ul>
    </section>
{% endmacro %}

{% block content %}
{% include 'components/navigation.html' %}





<div class="container bg-white border rounded my-2">
    <div class="row mb-3">
        <div class="col text-center add-item-container">
            <button class="btn btn-link" type="button" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                <i class="bi bi-plus-circle"></i>
            </button>
        </div>
    </div>
    {{ self::forest(nodes=category_tree) }}
</div>

{% include 'categories/add_category_modal.html' %}
{% include 'categories/edit_category_modal.html' %}

{% endblock %}
{% block scripts %}{% endblock %}
